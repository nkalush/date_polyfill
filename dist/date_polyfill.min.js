var datepickerPolyfill=function(document){"use strict";function getParent(el,parentSelector){if(el&&parentSelector){if(el.msMatchesSelector)for(;el&&el.msMatchesSelector(parentSelector)===!1;)el=el.parentElement;else if(el.matches)for(;el&&el.matches(parentSelector)===!1;)el=el.parentElement;return el}return!1}function getDatepicker(element){var len,i;for(i=0,len=datepickers.length;len>i;i+=1)if(datepickers[i].wrapper===element)return datepickers[i];return!1}function DatePicker(input){this.input=input,this.active_field=null,this.current_date="",this.date=new Date,this.month=!1,this.day=!1,this.year=!1,this.wrapper=!1,this.monthInput=!1,this.dayInput=!1,this.yearInput=!1,this.clearBtn=!1,this.upBtn=!1,this.downBtn=!1,this.blurClick=!1,this.init_input=function(){var datepicker=this,wrapper=document.createElement("div"),realinput=this.input.cloneNode(!0);wrapper.setAttribute("class",realinput.getAttribute("class")),wrapper.classList.add("pf-date-wrapper"),wrapper.innerHTML='<input type="text" class="pf-input-date-month" maxlength="2" value="mm">/<input type="text" class="pf-input-date-day" maxlength="2" value="dd">/<input type="text" class="pf-input-date-year" maxlength="4" value="yyyy"><button tabindex="-1" class="pf-input-date-clear"></button><button tabindex="-1" class="pf-input-date-up"></button><button tabindex="-1" class="pf-input-date-down"></button><button tabindex="-1" class="pf-input-date-toggle-cal"></button>',realinput.setAttribute("class","pf-input-real"),wrapper.appendChild(realinput),this.input=this.input.parentNode.replaceChild(wrapper,this.input),datepicker.wrapper=wrapper,datepicker.monthInput=wrapper.querySelector(".pf-input-date-month"),datepicker.dayInput=wrapper.querySelector(".pf-input-date-day"),datepicker.yearInput=wrapper.querySelector(".pf-input-date-year"),datepicker.clearBtn=wrapper.querySelector(".pf-input-date-clear"),datepicker.upBtn=wrapper.querySelector(".pf-input-date-up"),datepicker.downBtn=wrapper.querySelector(".pf-input-date-down"),-1!==window.navigator.userAgent.indexOf(".NET")||-1!==window.navigator.userAgent.indexOf("MSIE ")?(document.removeEventListener("focusout",this.blurEvent,!1),document.addEventListener("focusout",this.blurEvent,!1)):(document.removeEventListener("blur",this.blurEvent,!0),document.addEventListener("blur",this.blurEvent,!0)),wrapper.removeEventListener("click",datepicker,!1),wrapper.addEventListener("click",datepicker,!1),this.upBtn.removeEventListener("click",datepicker,!1),this.upBtn.addEventListener("click",datepicker,!1),this.downBtn.removeEventListener("click",datepicker,!1),this.downBtn.addEventListener("click",datepicker,!1),this.clearBtn.removeEventListener("click",datepicker,!1),this.clearBtn.addEventListener("click",datepicker,!1),document.removeEventListener("focus",this.focusEvent,!0),document.addEventListener("focus",this.focusEvent,!0),document.removeEventListener("keyup",this.keyUpEvent,!1),document.addEventListener("keyup",this.keyUpEvent,!1)},this.init_input(),delete this.init_input,this.update=function(){this.monthInput.value=this.month?this.zerofill(2,this.month):"mm",this.dayInput.value=this.day?this.zerofill(2,this.day):"dd",this.yearInput.value=this.year?this.zerofill(4,this.year):"yyyy",this.clearBtn.style.display=this.month!==!1||this.day!==!1||this.year!==!1?"block":"none"}}function publicInit(elements){var len,i;for(void 0===elements.length&&(elements=[elements]),i=0,len=elements.length;len>i;i+=1)datepickers.push(new DatePicker(elements[i]))}var datepickers=[];return DatePicker.prototype.keyUpEvent=function(e){var wrapper=getParent(e.target,".pf-date-wrapper"),datepicker=getDatepicker(wrapper);if(datepicker.active_field&&datepicker.active_field.parentNode===wrapper)switch(e.keyCode){case 38:datepicker.upEvent(datepicker);break;case 40:datepicker.downEvent();break;case 39:datepicker.rightEvent();break;case 37:datepicker.leftEvent();break;case 8:case 46:datepicker.deleteEvent()}},DatePicker.prototype.focusEvent=function(e){var wrapper=getParent(e.target,".pf-date-wrapper"),datepicker=getDatepicker(wrapper);e.target&&e.target.parentNode===wrapper&&e.target.classList&&(e.target.classList.contains("pf-input-date-year")||e.target.classList.contains("pf-input-date-month")||e.target.classList.contains("pf-input-date-day"))&&(isNaN(parseInt(e.target.value,10))===!0&&(e.target.classList.contains("pf-input-date-year")&&datepicker.increment_year(!1),e.target.classList.contains("pf-input-date-month")&&datepicker.increment_month(!1),e.target.classList.contains("pf-input-date-day")&&datepicker.increment_day(!1)),datepicker.active_field=e.target,wrapper.classList.add("pf-wrapper-focused"))},DatePicker.prototype.blurEvent=function(e){var relatedTarget=null,dp_el=getParent(e.target,".pf-date-wrapper"),datepicker=getDatepicker(dp_el),refocusTimeout=50;dp_el&&datepicker&&(datepicker.isElement(e.explicitOriginalTarget)?relatedTarget=e.explicitOriginalTarget:datepicker.isElement(e.relatedTarget)&&(relatedTarget=e.relatedTarget),relatedTarget&&relatedTarget===datepicker.upBtn?(e.preventDefault(),datepicker.blurClick=!0,e.target===datepicker.yearInput?(datepicker.increment_year(1),setTimeout(function(){datepicker.yearInput.focus()},refocusTimeout)):e.target===datepicker.monthInput?(datepicker.increment_month(1),setTimeout(function(){datepicker.monthInput.focus()},refocusTimeout)):e.target===datepicker.dayInput&&(datepicker.increment_day(1),setTimeout(function(){datepicker.dayInput.focus()},refocusTimeout))):relatedTarget&&relatedTarget===datepicker.downBtn&&(e.preventDefault(),datepicker.blurClick=!0,e.target===datepicker.yearInput?(datepicker.increment_year(-1),setTimeout(function(){datepicker.yearInput.focus()},refocusTimeout)):e.target===datepicker.monthInput?(datepicker.increment_month(-1),setTimeout(function(){datepicker.monthInput.focus()},refocusTimeout)):e.target===datepicker.dayInput&&(datepicker.increment_day(-1),setTimeout(function(){e.target.focus()},refocusTimeout))))},DatePicker.prototype.zerofill=function(len,value){var n=Math.abs(value),zeros=Math.max(0,len-Math.floor(n).toString().length),zeroString=Math.pow(10,zeros).toString().substr(1);return 0>value&&(zeroString="-"+zeroString),zeroString+n},DatePicker.prototype.isElement=function(el){return"object"==typeof HTMLElement?el instanceof HTMLElement:el&&"object"==typeof el&&null!==el&&1===el.nodeType&&"string"==typeof el.nodeName},DatePicker.prototype.increment_day=function(amount){var newValue;amount===!1?this.day=!1:this.day===!1?this.day=this.date.getDate():(newValue=this.day+amount,this.day=newValue>31?1:1>newValue?31:newValue),this.update()},DatePicker.prototype.increment_month=function(amount){var newValue;amount===!1?this.month=!1:this.month===!1?this.month=this.date.getMonth()+1:(newValue=this.month+amount,this.month=newValue>12?1:1>newValue?12:newValue),this.update()},DatePicker.prototype.increment_year=function(amount){var newValue;amount===!1?this.year=!1:this.year===!1?this.year=this.date.getFullYear():(newValue=this.year+amount,this.year=0>newValue?this.date.getFullYear():newValue),this.update()},DatePicker.prototype.upEvent=function(){this.active_field.classList.contains("pf-input-date-year")&&this.increment_year(1),this.active_field.classList.contains("pf-input-date-month")&&this.increment_month(1),this.active_field.classList.contains("pf-input-date-day")&&this.increment_day(1)},DatePicker.prototype.downEvent=function(){this.active_field.classList.contains("pf-input-date-year")&&this.increment_year(-1),this.active_field.classList.contains("pf-input-date-month")&&this.increment_month(-1),this.active_field.classList.contains("pf-input-date-day")&&this.increment_day(-1)},DatePicker.prototype.leftEvent=function(){var i,inputs=this.active_field.parentNode.querySelectorAll("input"),len=inputs.length;for(i=0;len>i;i+=1)if(0!==i&&inputs[i]===this.active_field){inputs[i-1].focus(),this.active_field=inputs[i-1];break}},DatePicker.prototype.rightEvent=function(){var i,inputs=this.active_field.parentNode.querySelectorAll("input"),len=inputs.length;for(i=0;len>i;i+=1)if(i!==len-1&&inputs[i]===this.active_field){inputs[i+1].focus(),this.active_field=inputs[i+1];break}},DatePicker.prototype.deleteEvent=function(){this.active_field.classList.contains("pf-input-date-year")&&this.increment_year(!1),this.active_field.classList.contains("pf-input-date-month")&&this.increment_month(!1),this.active_field.classList.contains("pf-input-date-day")&&this.increment_day(!1)},DatePicker.prototype.handleEvent=function(e){e.stopPropagation(),"click"===e.type&&(e.target===this.wrapper?this.monthInput.focus():e.target===this.clearBtn?(this.month=!1,this.day=!1,this.year=!1,this.update()):e.target===this.upBtn?this.blurClick===!1?(this.monthInput.focus(),this.increment_month(1)):this.blurClick=!1:e.target===this.downBtn&&(this.blurClick===!1?(this.monthInput.focus(),this.increment_month(-1)):this.blurClick=!1))},{init:publicInit}}(document);