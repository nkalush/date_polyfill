!function(document){"use strict";function setValue(el,len,value){var n=Math.abs(value),zeros=Math.max(0,len-Math.floor(n).toString().length),zeroString=Math.pow(10,zeros).toString().substr(1);0>value&&(zeroString="-"+zeroString),el.value=zeroString+n}function increment_day(datepicker,amount){var newValue,dayInput=datepicker.querySelector(".pf-input-date-day");amount===!1?dayInput.value="dd":""===dayInput.value||isNaN(dayInput.value)?setValue(dayInput,2,date.getDate()):(newValue=parseInt(dayInput.value,10)+amount,newValue>31?setValue(dayInput,2,1):1>newValue?setValue(dayInput,2,31):setValue(dayInput,2,newValue))}function increment_month(datepicker,amount){var newValue,monthInput=datepicker.querySelector(".pf-input-date-month");amount===!1?monthInput.value="mm":""===monthInput.value||isNaN(monthInput.value)?setValue(monthInput,2,date.getMonth()+1):(newValue=parseInt(monthInput.value,10)+amount,newValue>12?setValue(monthInput,2,1):1>newValue?setValue(monthInput,2,12):setValue(monthInput,2,newValue))}function increment_year(datepicker,amount){var newValue,yearInput=datepicker.querySelector(".pf-input-date-year");amount===!1?yearInput.value="yyyy":""===yearInput.value||isNaN(yearInput.value)?setValue(yearInput,4,date.getFullYear()):(newValue=parseInt(yearInput.value,10)+amount,0>newValue?setValue(yearInput,2,date.getFullYear()):setValue(yearInput,2,newValue))}function init_input(input){var wrapper=document.createElement("div"),year=document.createElement("input"),month=document.createElement("input"),day=document.createElement("input"),clear=document.createElement("button"),up=document.createElement("button"),down=document.createElement("button"),toggleCalendar=document.createElement("button");wrapper.setAttribute("class",input.getAttribute("class")),wrapper.classList.add("pf-date-wrapper"),input.style.display="none",year.classList.add("pf-input-date-year"),month.classList.add("pf-input-date-month"),day.classList.add("pf-input-date-day"),year.setAttribute("type","text"),month.setAttribute("type","text"),day.setAttribute("type","text"),year.setAttribute("value","yyyy"),year.setAttribute("maxlength",4),month.setAttribute("value","mm"),month.setAttribute("maxlength",2),day.setAttribute("value","dd"),day.setAttribute("maxlength",2),clear.classList.add("pf-input-date-clear"),up.classList.add("pf-input-date-up"),down.classList.add("pf-input-date-down"),toggleCalendar.classList.add("pf-input-date-toggle-cal"),clear.setAttribute("tabindex",-1),up.setAttribute("tabindex",-1),down.setAttribute("tabindex",-1),toggleCalendar.setAttribute("tabindex",-1),wrapper.appendChild(month),wrapper.innerHTML=wrapper.innerHTML+"/",wrapper.appendChild(day),wrapper.innerHTML=wrapper.innerHTML+"/",wrapper.appendChild(year),wrapper.appendChild(clear),wrapper.appendChild(up),wrapper.appendChild(down),wrapper.appendChild(toggleCalendar),input.outerHTML=input.outerHTML+wrapper.outerHTML}function upEvent(){var datepicker=active_field.parentNode;active_field.classList.contains("pf-input-date-year")&&increment_year(datepicker,1),active_field.classList.contains("pf-input-date-month")&&increment_month(datepicker,1),active_field.classList.contains("pf-input-date-day")&&increment_day(datepicker,1)}function downEvent(){var datepicker=active_field.parentNode;active_field.classList.contains("pf-input-date-year")&&increment_year(datepicker,-1),active_field.classList.contains("pf-input-date-month")&&increment_month(datepicker,-1),active_field.classList.contains("pf-input-date-day")&&increment_day(datepicker,-1)}function leftEvent(){var i,inputs=active_field.parentNode.querySelectorAll("input"),len=inputs.length;for(i=0;len>i;i+=1)if(0!==i&&inputs[i]===active_field){inputs[i-1].focus(),active_field=inputs[i-1];break}}function rightEvent(){var i,inputs=active_field.parentNode.querySelectorAll("input"),len=inputs.length;for(i=0;len>i;i+=1)if(i!==len-1&&inputs[i]===active_field){inputs[i+1].focus(),active_field=inputs[i+1];break}}function deleteEvent(){var datepicker=active_field.parentNode;active_field.classList.contains("pf-input-date-year")&&increment_year(datepicker,!1),active_field.classList.contains("pf-input-date-month")&&increment_month(datepicker,!1),active_field.classList.contains("pf-input-date-day")&&increment_day(datepicker,!1)}function clickWrapperEvent(e){var firstInput=e.target.querySelector("input");firstInput&&firstInput.focus()}function upBtnEvent(e){var datepicker=e.target.parentNode;active_field&&datepicker===active_field.parentNode||(datepicker.querySelector(".pf-input-date-month").focus(),increment_month(datepicker,1))}function downBtnEvent(e){var datepicker=e.target.parentNode;active_field&&datepicker===active_field.parentNode||(datepicker.querySelector(".pf-input-date-month").focus(),increment_month(datepicker,-1))}function init(){var i,date_inputs=document.querySelectorAll(".input_date"),len=date_inputs.length;for(i=0;len>i;i+=1)init_input(date_inputs[i]);for(date_inputs=document.querySelectorAll(".pf-date-wrapper"),len=date_inputs.length,i=0;len>i;i+=1)date_inputs[i].addEventListener("click",clickWrapperEvent,!1),date_inputs[i].querySelector(".pf-input-date-up").addEventListener("click",upBtnEvent,!1),date_inputs[i].querySelector(".pf-input-date-down").addEventListener("click",downBtnEvent,!1);document.addEventListener("focus",function(e){var datepicker=e.target.parentNode;(e.target.classList.contains("pf-input-date-year")||e.target.classList.contains("pf-input-date-month")||e.target.classList.contains("pf-input-date-day"))&&(isNaN(parseInt(e.target.value,10))===!0&&(e.target.classList.contains("pf-input-date-year")&&increment_year(datepicker,!1),e.target.classList.contains("pf-input-date-month")&&increment_month(datepicker,!1),e.target.classList.contains("pf-input-date-day")&&increment_day(datepicker,!1)),active_field=e.target,datepicker.classList.add("pf-wrapper-focused"))},!0),document.addEventListener("blur",function(e){if(e.target.classList.contains("pf-input-date-year")||e.target.classList.contains("pf-input-date-month")||e.target.classList.contains("pf-input-date-day")){var datepicker=e.target.parentNode;e.relatedTarget&&e.relatedTarget.classList.contains("pf-input-date-up")&&e.relatedTarget.parentNode===e.target.parentNode?(e.preventDefault(),e.target.classList.contains("pf-input-date-year")&&increment_year(datepicker,1),e.target.classList.contains("pf-input-date-month")&&increment_month(datepicker,1),e.target.classList.contains("pf-input-date-day")&&increment_day(datepicker,1),setTimeout(function(){e.target.focus()},20)):e.relatedTarget&&e.relatedTarget.classList.contains("pf-input-date-down")&&e.relatedTarget.parentNode===e.target.parentNode?(e.preventDefault(),e.target.classList.contains("pf-input-date-year")&&increment_year(datepicker,-1),e.target.classList.contains("pf-input-date-month")&&increment_month(datepicker,-1),e.target.classList.contains("pf-input-date-day")&&increment_day(datepicker,-1),setTimeout(function(){e.target.focus()},20)):(e.target.classList.contains("pf-input-date-year")&&""===e.target.value&&(e.target.value="yyyy"),e.target.classList.contains("pf-input-date-month")&&""===e.target.value&&(e.target.value="mm"),e.target.classList.contains("pf-input-date-day")&&""===e.target.value&&(e.target.value="dd"),active_field=null,e.target.parentNode.classList.remove("pf-wrapper-focused"))}},!0),document.addEventListener("keyup",function(e){if(null!==active_field)switch(e.keyCode){case 38:upEvent();break;case 40:downEvent();break;case 39:rightEvent();break;case 37:leftEvent();break;case 8:case 46:deleteEvent()}},!1)}var active_field=null,date=new Date;document.addEventListener("DOMContentLoaded",function(){init()})}(document);